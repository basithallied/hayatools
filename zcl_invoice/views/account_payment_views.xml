<?xml version="1.0"?>
<odoo>
    <!--    xml to add new fields to the account.payment-->
    <record id="view_account_payment_form" model="ir.ui.view">
        <field name="name">account.payment.view.form.inherit</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_form"/>
        <field name="arch" type="xml">
             <xpath expr="//div[@name='amount_div']" position="after">
                <field name="partner_total_payable" sum="Payable Amount"/>
                <field name="partner_total_receivable" sum="Receivable Amount"/>
            </xpath>
            <xpath expr="//form/header" position="inside">
                <button name="action_view_unpaid_invoices" string="Reconcile" type="object" class="oe_highlight" invisible="state != 'paid' or  payment_type != 'inbound' or is_reconciled"/>/>
                <button name="action_view_unpaid_bills" string="Reconcile" type="object" class="oe_highlight" invisible="state != 'paid' or  payment_type != 'outbound' or is_reconciled"/>
            </xpath>
            <xpath expr="//sheet/group[@name='main_group']//div[@name='amount_div']//field[@name='currency_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='amount']" position="after">
                <field name="currency_id" options="{'no_create': True, 'no_open': True}" required="1" />
            </xpath>
             <xpath expr="//field[@name='payment_type']" position="after">
                 <field name="internal_transfers" invisible="branch_transfers or payment_expense " class="oe_inline" string="Internal Transfer" readonly="state != 'draft'" />
                 <field name="branch_transfers" invisible="internal_transfers or payment_expense" class="oe_inline" string="Branch Transfer" readonly="state != 'draft'" />
                 <field name="payment_expense" invisible="internal_transfers or branch_transfers" class="oe_inline" readonly="state != 'draft'"/>
            </xpath>
             <xpath expr="//field[@name='journal_id']" position="after">
                <field name="destination_journal_id" options="{'no_create': True, 'no_open': True}" required="internal_transfers" invisible="not internal_transfers" readonly="state != 'draft'"/>
            </xpath>
            <xpath expr="//field[@name='journal_id']" position="after">
                <field name="expense_account_id" options="{'no_create': True, 'no_open': True}" required="payment_expense" invisible="not payment_expense" readonly="state != 'draft'" force_save="1"/>
            </xpath>
            <xpath expr="//button[@name='action_draft']" position="attributes">
                <attribute name="invisible">internal_transfers or payment_expense</attribute>
            </xpath>
        </field>
    </record>
</odoo>
